Дано:
Директория, в которой лежат файлы по следующей структуре: <topic_name>/history/<run_timestamp>/offsets.csv
<topic_name> - имя топика (по сути просто строка) <run_timestamp> - таймстемп запуска некоей процедуры, в формате YYYY-MM-DD-HH-mm-ss (минуты и секунды с лидирующими нулями) offsets.csv - файл с двумя колонками, разделенными запятыми. Первая колонка - номер партиции (int), вторая колонка - число сообщений (long). В одном файле десятки записей.

Нужно разработать REST-сервис, который позволяет получить:
- Список топиков, данные по которым есть данные в этой директории
- По каждому топику, таймстемп последнего запуска
- По каждому топику, для последнего запуска, статистику: суммарное число сообщений во всех партициях, максимальное/минимальное число сообщений, среднее число сообщений
- По каждому топику, список партиций и число сообщений по каждой партиции во время последнего запуска

Сервис должен поставляться в виде запускаемого jar-файла, параметром запуска сервиса должен быть base_dir - директория откуда начинать искать топики. Сборка через maven, контейнер для приложения - http://projects.spring.io/spring-boot/ Все остальное - на ваше усмотрение.


Пример использования API
localhost:8080/topic
localhost:8080/topic/1984-12-19-00-00-00
localhost:8080/topic/1984-12-19-00-00-00/lastRun
localhost:8080/topic/1984-12-19-00-00-00/lastRun/stats    